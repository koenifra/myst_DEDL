{"version":2,"kind":"Notebook","sha256":"d63a97ad32eb09e99d92466aa5fc397034744fca10181bec9c6d0c4e08cccac5","slug":"tutorial-1","location":"/HOOK/Tutorial.ipynb","dependencies":[],"frontmatter":{"title":"DEDL - Hook Tutorial - Data Harvest (data-harvest)","tags":["Authentification","Workflow","Storage"],"authors":[{"id":"Author: EUMETSAT","name":"Author: EUMETSAT"}],"kernelspec":{"name":"python3","display_name":".venv","language":"python"},"numbering":{"title":{"offset":2}},"exports":[{"format":"ipynb","filename":"Tutorial.ipynb","url":"/Tutorial-ac3908329231b5724f5234c5f12f3faf.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This notebook demonstrates how to use the Hook service.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jl8qoIFcg5"}],"key":"Eoy0aFUaV8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The detailed API and definition of each endpoint and parameters is available in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MMp32m1qAJ"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"OnDemand Processing API OData v1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AyFioZSNXV"}],"key":"znWH2CAc38"},{"type":"text","value":"  OpenAPI documentation found at:\n","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vYgHF63bE7"},{"type":"link","url":"https://odp.data.destination-earth.eu/odata/docs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"https://​odp​.data​.destination​-earth​.eu​/odata​/docs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VUJdtdgUqF"}],"urlSource":"https://odp.data.destination-earth.eu/odata/docs","key":"CekrRKsoy3"}],"key":"dZ2t2rnPR9"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Further documentation is available at:\n","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vPSNDv4lsR"},{"type":"link","url":"https://destine-data-lake-docs.data.destination-earth.eu/en/latest/dedl-big-data-processing-services/Hook-service/Hook-service.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"https://​destine​-data​-lake​-docs​.data​.destination​-earth​.eu​/en​/latest​/dedl​-big​-data​-processing​-services​/Hook​-service​/Hook​-service​.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NtQWCeS6Mq"}],"urlSource":"https://destine-data-lake-docs.data.destination-earth.eu/en/latest/dedl-big-data-processing-services/Hook-service/Hook-service.html","key":"uN92GiZ52E"}],"key":"s1eTTClSTm"}],"visibility":"show","key":"BXjQti5Oq1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Install python package requirements and import environment variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GOEeV8bn8O"}],"identifier":"install-python-package-requirements-and-import-environment-variables","label":"Install python package requirements and import environment variables","html_id":"install-python-package-requirements-and-import-environment-variables","implicit":true,"key":"X5bG0AaAGy"}],"key":"h7Z4bm77px"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Note: The destinelab python package (which helps with authentication) is available already if you are using Python DEDL kernel\n# Otherwise, the destinelab python package can be installed by uncommenting the following line\n\n# For the importing of environment variables using the load_dotenv(...) command \n%pip install python-dotenv\n# for example code navigating private S3 compatible storage (PRIVATE bucket storage)\n%pip install boto3\n","visibility":"show","key":"k2h1A551Lo"},{"type":"output","id":"wORMHAmP48VxUSHnZeZm6","data":[],"visibility":"show","key":"kXrbBAGbp7"}],"visibility":"show","key":"FqEWojiAC9"},{"type":"block","kind":"notebook-code","data":{"id":"oyJN4WaVsz2S","tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport json\nimport requests\nfrom dotenv import load_dotenv\nfrom getpass import getpass\nimport destinelab as destinelab\n\n# Load (optional) notebook specific environment variables from .env_tutorial\nload_dotenv(\"./.env_tutorial\", override=True)","identifier":"oyjn4wavsz2s-code","visibility":"show","enumerator":"1","html_id":"oyjn4wavsz2s-code","key":"SOysStWrKG"},{"type":"output","id":"QAhckPyER2Sl_aVL2gVtR","data":[],"identifier":"oyjn4wavsz2s-output","visibility":"show","html_id":"oyjn4wavsz2s-output","key":"KT502X8CiV"}],"identifier":"oyjn4wavsz2s","label":"oyJN4WaVsz2S","html_id":"oyjn4wavsz2s","visibility":"show","key":"UURvhAXuxB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Authentification - Get token","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GYgBoogWxO"}],"identifier":"authentification-get-token","label":"Authentification - Get token","html_id":"authentification-get-token","implicit":true,"key":"JU0ikX9eEg"}],"key":"B9LaWIjfF2"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# By default users should use their DESP credentials to get an Access_token\n# This token is added as an Authorisation Header when interacting with the Hook Service API\n\n# Enter DESP credentials.\nDESP_USERNAME = input(\"Please input your DESP username or email: \")\nDESP_PASSWORD = getpass(\"Please input your DESP password: \")\ntoken = destinelab.AuthHandler(DESP_USERNAME, DESP_PASSWORD)\n\naccess_token = token.get_token()\n\n# Check the status of the request\nif access_token is not None:\n    print(\"DEDL/DESP Access Token Obtained Successfully\")\n    # Save API headers\n    api_headers = {\"Authorization\": \"Bearer \" + access_token}\nelse:\n    print(\"Failed to Obtain DEDL/DESP Access Token\")","visibility":"show","key":"SOJEiavIdN"},{"type":"output","id":"zU4NH9BUSdMvywhJ0hNDR","data":[],"visibility":"show","key":"JV5wZZLbGq"}],"visibility":"show","key":"BqvpxU5761"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setup static variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bQyaCHdLZm"}],"identifier":"setup-static-variables","label":"Setup static variables","html_id":"setup-static-variables","implicit":true,"key":"WlyVY2sTQR"}],"key":"mU0o0xFBJB"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Hook service url (ending with odata/v1/ - e.g. https://odp.data.destination-earth.eu/odata/v1/)\nhook_service_root_url = \"https://odp.data.destination-earth.eu/odata/v1/\"","visibility":"show","key":"fRK8ZuyCAV"},{"type":"output","id":"Supjm0rxLTWIUVu-mY5vy","data":[],"visibility":"show","key":"UEuzcw8BUd"}],"visibility":"show","key":"jh9V2v4bpJ"},{"type":"block","kind":"notebook-content","data":{"id":"OlvgrvV3sz2Y"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"List available workflows","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wvV16ymy86"}],"identifier":"list-available-workflows","label":"List available workflows","html_id":"list-available-workflows","implicit":true,"key":"lgREAURtHR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Next we can check what possible workflows are available to us by using method","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kShhv4gRCG"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vGpKOliVwk"},{"type":"inlineCode","value":"https://odp.data.destination-earth.eu/odata/v1/Workflows","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ql5yiEqSAF"}],"key":"pWQXyd50lI"}],"identifier":"olvgrvv3sz2y","label":"OlvgrvV3sz2Y","html_id":"olvgrvv3sz2y","key":"JiWt25pihN"},{"type":"block","kind":"notebook-code","data":{"id":"gSxYUs_0sz2Z","tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Send request and return json object listing all provided workfows, ordered by Id\nresult = requests.get(\n    f\"{hook_service_root_url}Workflows?$orderby=Id asc\", headers=api_headers   \n).json()\n\nprint(\"List of available DEDL provided Hooks\")\nfor i in range(len(result[\"value\"])):\n    print(\n        f\"Name:{str(result['value'][i]['Name']).ljust(20, ' ')}DisplayName:{str(result['value'][i]['DisplayName'])}\"\n    )  # print JSON string","identifier":"gsxyus_0sz2z-code","visibility":"show","enumerator":"2","html_id":"gsxyus-0sz2z-code","key":"fgf0HhWL2k"},{"type":"output","id":"oeLuI1HydSApAxzy8t7qa","data":[],"identifier":"gsxyus_0sz2z-output","visibility":"show","html_id":"gsxyus-0sz2z-output","key":"gb5oLNBffG"}],"identifier":"gsxyus_0sz2z","label":"gSxYUs_0sz2Z","html_id":"gsxyus-0sz2z","visibility":"show","key":"jutaA8KvKe"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Print result JSON object: containing provided workflow list\nworkflow_details = json.dumps(result, indent=4)\nprint(workflow_details)","visibility":"show","key":"qgwMMlVHIe"},{"type":"output","id":"4NbbFLaTXvQ5PsHxBrpI2","data":[],"visibility":"show","key":"gMfxjFSViA"}],"visibility":"show","key":"u0ICyi7dDP"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Select a workflow and see parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x0FGvHvMt8"}],"identifier":"select-a-workflow-and-see-parameters","label":"Select a workflow and see parameters","html_id":"select-a-workflow-and-see-parameters","implicit":true,"key":"SlmIRaX1dg"}],"visibility":"show","key":"Cdr0rsbC0z"},{"type":"block","kind":"notebook-content","data":{"id":"jNSqMuRCsz2Z"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we want to see the details of a specific workflow, showing us the parameters that can be set for that workflow, we can add a filter to the query as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P73MJPufpF"}],"key":"xwcuS3HDY7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"https://odp.data.destination-earth.eu/odata/v1/Workflows?$expand=WorkflowOptions&$filter=(Name eq data-harvest)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d4fxptRofl"}],"key":"pPqrKh35wR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"\\","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FfmUMLbzYJ"},{"type":"inlineMath","value":"expand=WorkflowOptions** shows all parameters accepted by workflow   \n**\\\\","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo>=</mo><mi>W</mi><mi>o</mi><mi>r</mi><mi>k</mi><mi>f</mi><mi>l</mi><mi>o</mi><mi>w</mi><mi>O</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>∗</mo><mo>∗</mo><mi>s</mi><mi>h</mi><mi>o</mi><mi>w</mi><mi>s</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>p</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>p</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>b</mi><mi>y</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>k</mi><mi>f</mi><mi>l</mi><mi>o</mi><mi>w</mi><mo>∗</mo><mo>∗</mo><mspace linebreak=\"newline\"></mspace></mrow><annotation encoding=\"application/x-tex\">expand=WorkflowOptions** shows all parameters accepted by workflow   \n**\\\\</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">wOpt</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">∗</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">llp</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">am</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">ers</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">cce</span><span class=\"mord mathnormal\">pt</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord\">∗</span></span><span class=\"mspace newline\"></span></span></span>","key":"PS6ItYAbdD"},{"type":"text","value":"filter=(Name eq data-harvest)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tWyUYcehPV"}],"key":"HgzC4D0wKA"},{"type":"text","value":" narrows the result to workflow called “data-harvest”","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cnOP5xhnyt"}],"key":"nYF5Ug4Tll"}],"identifier":"jnsqmurcsz2z","label":"jNSqMuRCsz2Z","html_id":"jnsqmurcsz2z","key":"liTMva64xt"},{"type":"block","kind":"notebook-code","data":{"id":"UEvKzPclsz2b","tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Select workflow : defaults to data-harvest\nworkflow = os.getenv(\"HOOK_WORKFLOW\", \"data-harvest\")\nprint(f\"workflow: {workflow}\")\n\n# Send request\nresult = requests.get(\n    f\"{hook_service_root_url}Workflows?$expand=WorkflowOptions&$filter=(Name eq '{workflow}')\",\n    headers=api_headers,\n).json()\nworkflow_details = json.dumps(result, indent=4)\nprint(workflow_details)  # print formatted workflow_details, a JSON string","identifier":"uevkzpclsz2b-code","visibility":"show","enumerator":"3","html_id":"uevkzpclsz2b-code","key":"crnlBcEsn2"},{"type":"output","id":"1PXbt0xuwBJr7GDLQPgYP","data":[],"identifier":"uevkzpclsz2b-output","visibility":"show","html_id":"uevkzpclsz2b-output","key":"Dy60LSZ0gV"}],"identifier":"uevkzpclsz2b","label":"UEvKzPclsz2b","html_id":"uevkzpclsz2b","visibility":"show","key":"dmZsWktHU5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Order selected workflow","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lIZVXg6H9o"}],"identifier":"order-selected-workflow","label":"Order selected workflow","html_id":"order-selected-workflow","implicit":true,"key":"AuYKZYob6h"}],"key":"W3z972obbe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The order selected above will now be configured and executed.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gGBUXW7BWj"}],"key":"iY1nptiXRm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"e.g. workflow = “data-harvest”.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yIfh7evenE"}],"key":"QwlJsezBhV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Make an order to ‘harvest data’ using Harmonised Data Access API.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ceKz3SIScX"}],"key":"b8UXP6DH4C"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"i.e. data from an input source can be transferred to a Private bucket or a Temporary storage bucket.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"s4SHV4b2Cg"}],"key":"IxktkTbeQ3"}],"key":"gzzMoYTRyH"}],"key":"w8riAmgAkv"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Name your order","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ihiO1BlNJi"}],"identifier":"name-your-order","label":"Name your order","html_id":"name-your-order","implicit":true,"key":"L5SXzoS1ir"}],"visibility":"show","key":"bEcMvvy8iq"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Here we set the variable order_name, this will allow us to:\n# Easily identify the running process (e.g. when checking the status)\n# order_name is added as a suffix to the order 'Name'\norder_name = os.getenv(\"HOOK_ORDER_NAME\") or input(\"Name your order: \")\nprint(f\"order_name:{order_name}\")","visibility":"show","key":"ZgqyTGUZJm"},{"type":"output","id":"oqh_0LJFjOUw9wimvIAFc","data":[],"visibility":"show","key":"y01Annmj2i"}],"visibility":"show","key":"e4GwQK0N4w"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define output storage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gPUC7cdqeR"}],"identifier":"define-output-storage","label":"Define output storage","html_id":"define-output-storage","implicit":true,"key":"MeXRSqeHDy"}],"key":"hNR8IZvHOs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In workflow parameters, among others values, storage to retreive the result has to be provided.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O2kWTtkc3o"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IjRSCKcKYc"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Two possibilites:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dLYCMMBfr1"}],"key":"ByagPDxZBA"}],"key":"M6bOl5oo55"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Use your user storage","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eQ1SjLWMjh"}],"key":"uGxEiqTOXp"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Use a temporary storage","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AI4l6TheV1"}],"key":"jUFvMv86H6"}],"key":"kbJiewTpMq"}],"key":"RXXBfQw8Bt"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. - Your user storage (provided by DEDL ISLET service)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HDH02lkbDK"}],"identifier":"id-1-your-user-storage-provided-by-dedl-islet-service","label":"1. - Your user storage (provided by DEDL ISLET service)","html_id":"id-1-your-user-storage-provided-by-dedl-islet-service","implicit":true,"key":"iUu5BgQN9y"}],"visibility":"show","key":"SqtPfgdTge"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example using a S3 bucket created with ISLET Storage service  - result will be available in this bucket","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XmU9V1pGZP"}],"key":"iaJ5bnrpK0"},{"type":"blockquote","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"workflow parameter: {“Name”: “output_storage”, “Value”: “PRIVATE”}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wEvl0YtmST"}],"key":"JlNo9jCk8I"}],"key":"h9tJkZKy4Z"}],"key":"Xxx6O9LWdD"}],"key":"Pvv3kgl6oF"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Output storage - Islet service\n\n# Note: If you want the output to go to your own PRIVATE bucket rather than TEMPORARY storage (expires after 2 weeks),\n#       i) This Configuration will need to be updated with your output_bucket, output_storage_access_key, output_secret_key, output_prefix\n#       ii) You will need to change the output_storage in the order to PRIVATE and add the necessary source_ parameters (see workflow options and commented example)\n\n# URL of the S3 endpoint in the Central Site (or lumi etc.)\noutput_storage_url = \"https://s3.central.data.destination-earth.eu\"\n# output_storage_url = \"https://s3.lumi.data.destination-earth.eu\"\n\n# Name of the object storage bucket where the results will be stored.\noutput_bucket = os.getenv(\"HOOK_OUTPUT_BUCKET\", \"your-bucket-name\")\nprint(f\"output_bucket            : {output_bucket}\")\n\n# Islet object storage credentials (openstack ec2 credentials)\noutput_storage_access_key = os.getenv(\"HOOK_OUTPUT_STORAGE_ACCESS_KEY\", \"your-access-key\")\noutput_storage_secret_key = os.getenv(\"HOOK_OUTPUT_STORAGE_SECRET_KEY\", \"your-secret-key\")\nprint(f\"output_storage_access_key: {output_storage_access_key}\")\nprint(f\"output_storage_secret_key: {output_storage_secret_key}\")\n\n\n# This is the name of the folder in your output_bucket where the output of the hook will be stored.\n# Here we concatenate 'dedl' with the 'workflow' and 'order_name'\noutput_prefix = f\"dedl-{workflow}-{order_name}\"\nprint(f\"output_prefix            : {output_prefix}\")","visibility":"show","key":"EmgFdqans2"},{"type":"output","id":"Am32hoplhuLsL3nUNv-N9","data":[],"visibility":"show","key":"E021FA7qTR"}],"visibility":"show","key":"j8LbbSKMz6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2 - Use temporary storage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XGHefAnznD"}],"identifier":"id-2-use-temporary-storage","label":"2 - Use temporary storage","html_id":"id-2-use-temporary-storage","implicit":true,"key":"CMFJAuQqg0"}],"key":"sNtROTNkgI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The result of processing will be stored in shared storage and download link provided in the output product details","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TxbZG2nJZK"}],"key":"FqUUeTfQl2"},{"type":"blockquote","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"workflow parameter: {“Name”: “output_storage”, “Value”: “TEMPORARY”}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gWmwjlgfAL"}],"key":"kTmDMBIkpk"}],"key":"WGEAYjBEg2"}],"key":"BQSTYSe0eM"}],"key":"ubxUeAbNyw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define parameters and send order","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"slehu8vO9e"}],"identifier":"define-parameters-and-send-order","label":"Define parameters and send order","html_id":"define-parameters-and-send-order","implicit":true,"key":"hfSH3onF9H"}],"key":"mmISqTOaYk"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# URL of the STAC server where your collection/item can be downloaded\nstac_hda_api_url = \"https://hda.data.destination-earth.eu/stac\"\n\n# Note: The data (collection_id and data_id) will have been previously discovered and searched for\n\n# Set collection where the item can be found : defaults to example for data-harvest\ncollection_id = os.getenv(\"HOOK_COLLECTION_ID\", \"EO.ESA.DAT.SENTINEL-2.MSI.L1C\")\nprint(f\"STAC collection url: {stac_hda_api_url}/collections/{collection_id}\")\n\n# Set the Item to Retrieve : defaults to example for data-harvest. If Multiple Values, provide comma separated list\ndata_id = os.getenv(\"HOOK_DATA_ID\", \"S2A_MSIL1C_20230910T050701_N0509_R019_T47VLH_20230910T074321.SAFE\")\nprint(f\"data_id: {data_id}\")\nidentifier_list = [data_id_element.strip() for data_id_element in data_id.split(',')]\n\n# Get boolean value from String, default (False)\nis_private_storage = os.getenv(\"HOOK_IS_PRIVATE_STORAGE\", \"False\") == \"True\"\nprint(f\"is_private_storage: {is_private_storage}\")\n\n# we use source_type to add DESP or EXTERNAL specific configuration\nsource_type = os.getenv(\"HOOK_SOURCE_TYPE\", \"DESP\")\nprint(f\"source_type: {source_type}\")\n\nif source_type == \"EXTERNAL\":\n    EXTERNAL_USERNAME = os.getenv(\"HOOK_EXTERNAL_USERNAME\", \"EXTERNAL_USERNAME\")\n    EXTERNAL_PASSWORD = os.getenv(\"HOOK_EXTERNAL_PASSWORD\", \"EXTERNAL_PASSWORD\")\n    EXTERNAL_TOKEN_URL = os.getenv(\"HOOK_EXTERNAL_TOKEN_URL\", \"EXTERNAL_TOKEN_URL\")\n    EXTERNAL_CLIENT_ID = os.getenv(\"HOOK_EXTERNAL_CLIENT_ID\", \"EXTERNAL_CLIENT_ID\")","visibility":"show","key":"Wy1oUvUxCL"},{"type":"output","id":"-fFAMzHvjRH9OqvYRgicB","data":[],"visibility":"show","key":"wvC0wmEsbK"}],"visibility":"show","key":"EujtA25Pu7"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"########## BUILD ORDER BODY : CHOOSE PRIVATE or TEMPORARY output_storage ##########\n\n# Initialise the order_body\norder_body_custom_bucket = {\n    \"Name\": \"Tutorial \" + workflow + \" - \" + order_name,\n    \"WorkflowName\": workflow,\n    \"IdentifierList\": identifier_list,\n    \"WorkflowOptions\": [],\n}\n\n\n##### Configure PRIVATE OR TEMPORARY STORAGE #####\nif is_private_storage:\n\n    print(\"##### Preparing Order Body for PRIVATE STORAGE #####\")\n    order_body_custom_bucket[\"WorkflowOptions\"].extend(\n        [\n            {\"Name\": \"output_storage\", \"Value\": \"PRIVATE\"},\n            {\"Name\": \"output_s3_access_key\", \"Value\": output_storage_access_key},\n            {\"Name\": \"output_s3_secret_key\", \"Value\": output_storage_secret_key},\n            {\"Name\": \"output_s3_path\", \"Value\": f\"s3://{output_bucket}/{output_prefix}\"},\n            {\"Name\": \"output_s3_endpoint_url\", \"Value\": output_storage_url}\n        ]\n    )\n\nelse:\n\n    print(\"##### Preparing Order Body for TEMPORARY STORAGE #####\")\n    order_body_custom_bucket[\"WorkflowOptions\"].extend(\n        [\n            {\"Name\": \"output_storage\", \"Value\": \"TEMPORARY\"},\n        ]\n    )\n\n##### Configure SOURCE_TYPE and associated parameters #####\nif source_type == \"DESP\":\n\n    # Using DESP credentials is standard way of executing Hooks.\n    print(\"##### Preparing Order Body for access to DEDL HDA using DESP Credentials #####\")\n    order_body_custom_bucket[\"WorkflowOptions\"].extend(\n        [\n            {\"Name\": \"source_type\", \"Value\": \"DESP\"},\n            {\"Name\": \"desp_source_username\", \"Value\": DESP_USERNAME},\n            {\"Name\": \"desp_source_password\", \"Value\": DESP_PASSWORD},\n            {\"Name\": \"desp_source_collection\", \"Value\": collection_id}\n        ]\n    )\n\nelif source_type == \"EXTERNAL\":\n\n    # Build your order body : Example using EXTERNAL source type and source_catalogue_api_type STAC.\n    # This would allow you to access products directly from a configured STAC server\n    # Here we show an example configuration of a STAC server with OIDC security, that could be adapted to your needs (change urls, etc)\n    # This is shown for example purposes only. The standard way of configuring is with DESP source_type seen above.\n    print(\"##### Preparing Order Body for access to EXTERNAL STAC Server using EXTERNAL Credentials #####\")\n    order_body_custom_bucket[\"WorkflowOptions\"].extend(\n        [\n            {\"Name\": \"source_type\", \"Value\": \"EXTERNAL\"},\n            {\"Name\": \"source_catalogue_api_url\", \"Value\": stac_hda_api_url},\n            {\"Name\": \"source_catalogue_api_type\", \"Value\": \"STAC\"},\n            {\"Name\": \"source_token_url\", \"Value\": EXTERNAL_TOKEN_URL},\n            {\"Name\": \"source_grant_type\", \"Value\": \"PASSWORD\"},\n            {\"Name\": \"source_auth_header_name\", \"Value\": \"Authorization\"},\n            {\"Name\": \"source_username\", \"Value\": EXTERNAL_USERNAME},\n            {\"Name\": \"source_password\", \"Value\": EXTERNAL_PASSWORD},\n            {\"Name\": \"source_client_id\", \"Value\": EXTERNAL_CLIENT_ID},\n            {\"Name\": \"source_client_secret\", \"Value\": \"\"},\n            {\"Name\": \"source_catalogue_collection\", \"Value\": collection_id}\n        ]\n    )\n\nelse:\n\n    print(\"source_type not equal to DESP or EXTERNAL\")\n\n\n\n########## ADDITIONAL OPTIONS ##########\n\nadditional_options = []\n\n# Checks environment variables for the form HOOK_ADDITIONAL1=\"NAME=12345;VALUE=abcdef\"\nfor env_key, env_value in os.environ.items():\n    if env_key.startswith('HOOK_ADDITIONAL'):\n        #print(f\"{env_key}: {env_value}\")        \n        parts = env_value.split(';')\n        # Extract the name and value\n        name = parts[0].split('=')[1]\n        value = parts[1].split('=')[1]\n        value_type = parts[2].split('=')[1]\n        additional_options.append({\"Name\": name, \"Value\": value if value_type == 'str' else int(value)})\n\nprint(f\"addditional_options:{additional_options}\")\n\nif additional_options:\n    print(\"Adding additional_options\")\n    order_body_custom_bucket[\"WorkflowOptions\"].extend(additional_options)\n\n########## BUILD ORDER BODY : END ##########\n\n# Uncomment this to see the final order body\n# print(json.dumps(order_body_custom_bucket, indent=4))\n\n\n# Send order\norder_request = requests.post(\n    hook_service_root_url + \"BatchOrder/OData.CSC.Order\",\n    json.dumps(order_body_custom_bucket),\n    headers=api_headers,\n).json()\n\n# If code = 201, the order has been successfully sent\n\n# Print order_request JSON object: containing order_request details\norder_reques_details = json.dumps(order_request, indent=4)\nprint(order_reques_details)\n\norder_id = order_request['value']['Id']\nprint(f\"order 'Id' from order_request: {order_id}\")\n","visibility":"show","key":"nV7xluApwc"},{"type":"output","id":"hltxpkh8xN8fJpxMDB-pS","data":[],"visibility":"show","key":"tFYkMRXZcQ"}],"visibility":"show","key":"W5kCywDlgs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"It is possible to order multiple product using endpoint:\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yj5GFPG3Qa"},{"type":"inlineCode","value":"https://odp.data.destination-earth.eu/odata/v1/BatchOrder/OData.CSC.Order","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hWxJXQAt6q"}],"key":"Ogt87U8P6f"}],"key":"UBodJmOFif"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check The status of the order","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y135owbA2q"}],"identifier":"check-the-status-of-the-order","label":"Check The status of the order","html_id":"check-the-status-of-the-order","implicit":true,"key":"GVJiMlQCae"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Possible status values","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jP8ihaDbcU"}],"key":"nhYIRTiOIU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"queued (i.e. queued for treatment but not started)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Efu4D5sMJc"}],"key":"pueb4bZ1RU"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"in_progress (i.e. order being treated)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oiLfuJ9PHM"}],"key":"E2Xw05e4zB"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"completed (i.e. order is complete and data ready)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"iUkrB0zyKd"}],"key":"DnTssMDoTv"}],"key":"M4G9WBYIpY"}],"key":"DS7nVI4Oyd"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"\n# ProductionOrders endpoint gives status of orders (only with one item attached)\n# Otherwise use BatchOrder(XXXX)/Products endpoint to get status of individual items associated with order\nif len(identifier_list) == 1:\n    order_status_url = f\"{hook_service_root_url}ProductionOrders\"\n    params = {\"$filter\": f\"id eq {order_id}\"}\n    order_status_response = requests.get(order_status_url, params=params, headers=api_headers).json()\n    print(json.dumps(order_status_response, indent=4))\n\n# Get Status of all items of an order in this way\norder_status_response = requests.get(\n    f\"{hook_service_root_url}BatchOrder({order_id})/Products\",\n    headers=api_headers,\n).json()\nprint(json.dumps(order_status_response, indent=4))\n","visibility":"show","key":"WWiCEJLj5l"},{"type":"output","id":"FX2e2wIGn1iXSLjMjO9Ry","data":[],"visibility":"show","key":"knkLsDlWzP"}],"visibility":"show","key":"aDW3WmZIbW"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Access workflow output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Cc4MKJmMUp"}],"identifier":"access-workflow-output","label":"Access workflow output","html_id":"access-workflow-output","implicit":true,"key":"v6vI1zhgaf"}],"visibility":"show","key":"Le9BUNt1rn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Private storage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"loFsvYGI5U"}],"identifier":"private-storage","label":"Private storage","html_id":"private-storage","implicit":true,"key":"YMwGFEExkS"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let us now check our private storage using this boto3 script.\nYou can also go and check this in the Islet service using the Horizon user interface","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"eIVD6R2VdA"}],"key":"qxkZszqJmM"}],"key":"eEBeLiQxwo"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# PRIVATE STORAGE: Prints contents of Private Bucket\nimport boto3\n\nif is_private_storage:\n\n    s3 = boto3.client(\n        \"s3\",\n        aws_access_key_id=output_storage_access_key,\n        aws_secret_access_key=output_storage_secret_key,\n        endpoint_url=output_storage_url,\n    )\n\n    paginator = s3.get_paginator(\"list_objects_v2\")\n    pages = paginator.paginate(Bucket=output_bucket, Prefix=output_prefix + \"/\")\n\n    for page in pages:\n        try:\n            for obj in page[\"Contents\"]:\n                print(obj[\"Key\"])\n        except KeyError:\n            print(\"No files exist\")\n            exit(1)","visibility":"show","key":"HknXTFHllx"},{"type":"output","id":"2kZ8u7bwP-MIHPvLd2xVQ","data":[],"visibility":"show","key":"Lee8RTFzQQ"}],"visibility":"show","key":"szWONqbuun"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Temporary storage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u8hCIVD3WY"}],"identifier":"temporary-storage","label":"Temporary storage","html_id":"temporary-storage","implicit":true,"key":"S70wtLf4pt"}],"key":"APwt53NDux"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# List order items within a production order\n# When the output_storage is of type TEMPORARY we can get a DownloadLink from the following code (Can also optionally download items here in code with the flag is_download_products)\n\n# If TEMPORARY storage\nif not is_private_storage:\n\n    # Set to True to download products at the same level as the notebook file. File name will be in format \"output-{workflow}-{order_id}-{product_id}.zip\"\n    is_download_products = False\n\n    # Get Status of all items of an order in this way\n    product_status_response = requests.get(\n        f\"{hook_service_root_url}BatchOrder({order_id})/Products\",\n        headers=api_headers,\n    ).json()\n    print(json.dumps(product_status_response, indent=4))\n\n    if is_download_products:\n\n        is_all_products_completed = True\n        # We only attempt to download products when each of the items is in complete status.\n        for i in range(len(product_status_response[\"value\"])):\n\n            product_id = product_status_response[\"value\"][i][\"Id\"]\n            product_status = product_status_response[\"value\"][i][\"Status\"]\n\n            if product_status != \"completed\":\n                is_all_products_completed = False\n\n        # Can download if all products completed\n        if is_all_products_completed:\n\n            for i in range(len(product_status_response[\"value\"])):\n\n                product_id = product_status_response[\"value\"][i][\"Id\"]\n                product_status = product_status_response[\"value\"][i][\"Status\"]\n\n                # Infer the url of the product\n                url_product = f\"{hook_service_root_url}BatchOrder({order_id})/Product({product_id})/$value\"\n                print(f\"url_product: {url_product}\")\n                # Download the product\n                r = requests.get(\n                    url_product, headers=api_headers, allow_redirects=True\n                )\n                product_file_name = f\"output-{workflow}-{order_id}-{product_id}.zip\"\n                open(product_file_name, \"wb\").write(r.content)\n                print(f\"Download Complete: product_file_name: {product_file_name}\")\n\n        else:\n            print(f\"Status for order:{order_id} - At least one of the products does not have the status of 'completed'.\")\n","visibility":"show","key":"ZDACPbQoYw"},{"type":"output","id":"637vNu0Y8Sepw6RRf3LIP","data":[],"visibility":"show","key":"NGKnj3ZiLT"}],"visibility":"show","key":"lQsIZxU1yW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Copyright","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AlfwclTeFE"}],"key":"aicIUxNv1l"},{"type":"text","value":": 2024 EUMETSAT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d9VAZYW4iU"},{"type":"break","key":"aR9Tw9R9XZ"},{"type":"text","value":"\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vJvxFnRA8g"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Licence","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tLuxOdct0G"}],"key":"tvXqq3itSa"},{"type":"text","value":": MIT ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GZwJvGlPHz"},{"type":"break","key":"tpqGuUqF9i"}],"key":"jcEBVWmrfB"}],"key":"jw9LIf7mjW"}],"key":"SuGsrjwBJ8"},"references":{"cite":{"order":[],"data":{}}}}